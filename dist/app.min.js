var myApp=angular.module("myApp",["ui.router","angularMoment"]);myApp.run(function($rootScope){$rootScope.$on("$stateChangeError",console.log.bind(console))});myApp.controller("mainController",["$scope","$state",function($scope,$state){console.log("mainController loaded")}]);myApp.controller("albumListController",["$scope","albumService","$http","moment",function($scope,albumService,$http,moment){console.log("albumListController loaded");$scope.albums=[];$scope.newAlbum={name:"",date:"",description:""};albumService.getAlbums().then(function(res){$scope.albums=res.data.albums.map(function(album){album.date=moment.unix(album.date).format("YYYY-MM-DD","X");return album})});$scope.saveAlbum=function(){$scope.albums.push($scope.newAlbum);albumService.createAlbum($scope.newAlbum);$scope.newAlbum={}}}]);angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/");$stateProvider.state("home",{url:"/",templateUrl:"./content/albumList/albumList.content.html",controller:"albumListController"})}]);myApp.service("albumService",["$http",function($http){this.getAlbums=function(){return $http({method:"GET",url:"albums/"})};this.createAlbum=function(album){console.log(album,"service");return $http({method:"POST",url:"albums/",data:{al:album}})}}]);angular.module("myApp").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/");$stateProvider.state("album",{url:"/album",templateUrl:"./content/albumView/albumView.content.html",controller:"albumViewController"})}]);myApp.controller("albumViewController",["$scope","albumService",function($scope,albumService){$scope.photos={};$scope.photo={}}]);myApp.directive("ngFiles",["$parse",function($parse){function fn_link(scope,element,attrs){var onChange=$parse(attrs.ngFiles);element.on("change",function(event){onChange(scope,{$files:event.target.files})})}return{link:fn_link}}]).controller("uploadController",["$scope","$http",function($scope,$http){$scope.image={};$scope.getTheFiles=function($files){$scope.image=$files[0];var reader=new FileReader;reader.onload=function(evt){$scope.$apply(function($scope){$scope.image=evt.target.result})};reader.readAsDataURL($scope.image)};$scope.uploadFiles=function(){return $http({method:"POST",url:"/addPhoto/test3",data:{image:$scope.image}})}}]);angular.module("myApp").directive("navbar",function(){return{restrict:"E",templateUrl:"./directives/header/header.html"}});angular.module("myApp").directive("auDateMask",function(){return{restrict:"A",require:["?ngModel"],link:function(scope,element,attrs,ngModel){attrs.$observe("auDateMask",function(value){ngModel[0].$validators.dateMask=function(value){var year=value.substring(0,4),month=value.substring(5,7),day=value.substring(8,10);return 10==value.length&&!/[^0-9\/]/.test(value)&&"/"==value.substring(4,5)&&"/"==value.substring(7,8)&&Number(year)>1970&&Number(month)<=12&&Number(month)>0&&Number(day)<=31&&Number(day)>0}})}}});